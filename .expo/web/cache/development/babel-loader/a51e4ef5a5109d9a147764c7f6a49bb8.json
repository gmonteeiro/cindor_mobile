{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Volumes/SSD02/Documents/git/cindor_mobile/src/pages/ProgDate/index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport AsyncStorage from \"react-native-web/dist/exports/AsyncStorage\";\nimport { useNavigation } from '@react-navigation/native';\nimport { Feather } from '@expo/vector-icons';\nimport { ScrollView, TouchableOpacity } from 'react-native-gesture-handler';\nimport PageHeader from \"../../Components/PageHeader\";\nimport ActivityDetails from \"../../Components/ActivityDetails\";\nimport api from \"../../services/api\";\nimport styles from \"./styles\";\n\nfunction ProgDate() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      activities = _useState2[0],\n      setActivities = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      events = _useState4[0],\n      setEvents = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var eventDays = [\"27/12/1899\", \"28/12/1899\", \"29/12/1899\", \"30/12/1899\"];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      visibleItem = _useState8[0],\n      setvisibleItem = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      modalVisible = _useState10[0],\n      setModalVisible = _useState10[1];\n\n  var _useState11 = useState({}),\n      _useState12 = _slicedToArray(_useState11, 2),\n      currentActivity = _useState12[0],\n      setcurrentActivity = _useState12[1];\n\n  var navigation = useNavigation();\n\n  function handdleActivityDetails(act) {\n    setcurrentActivity(act);\n    setModalVisible(true);\n  }\n\n  function handdleVisibleItem(index) {\n    visibleItem === index ? setvisibleItem(null) : setvisibleItem(index);\n  }\n\n  function loadEvents() {\n    AsyncStorage.getItem('Events').then(function (res) {\n      if (res) {\n        var localData = JSON.parse(res);\n        console.log(localData);\n        var dateDiff = (new Date() - new Date(localData.datUpdate)) / 1000 / 60;\n\n        if (dateDiff > 30) {\n          console.log(dateDiff);\n          setEvents(localData.data);\n        }\n      } else {\n        getFromApi('?codEve=3').then(function (apiResponse) {\n          setEvents(apiResponse);\n          var localData = {\n            \"datUpdate\": new Date(),\n            \"data\": apiResponse\n          };\n          AsyncStorage.setItem('Events', JSON.stringify(localData));\n        });\n      }\n    });\n  }\n\n  function getFromApi(endPoint) {\n    var res, data;\n    return _regeneratorRuntime.async(function getFromApi$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(api.get(endPoint, {}));\n\n          case 2:\n            res = _context.sent;\n            data = res.data.map(function (a) {\n              return _objectSpread(_objectSpread({}, a), {}, {\n                iniOrder: a.HoraInicioAtividade.substring(0, 10).concat(a.HoraInicioAtividade.substring(11, 16)).concat(a.OrdemPalestra).replace(/:|-/g, \"\"),\n                HoraInicioAtividade: a.HoraInicioAtividade.substring(11, 16),\n                DataInicioAtividade: a.HoraInicioAtividade.substring(8, 10).concat(\"/\").concat(a.HoraInicioAtividade.substring(5, 7)).concat(\"/\").concat(a.HoraInicioAtividade.substring(0, 4)),\n                DataFimAtividade: a.HoraFimAtividade.substring(8, 10).concat(\"/\").concat(a.HoraFimAtividade.substring(5, 7)).concat(\"/\").concat(a.HoraFimAtividade.substring(0, 4)),\n                HoraFimAtividade: a.HoraFimAtividade.substring(11, 16)\n              });\n            });\n            return _context.abrupt(\"return\", data);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function loadActivities() {\n    AsyncStorage.getItem('Activities').then(function (res) {\n      console.log(res);\n      var loadData = [];\n\n      if (res) {\n        var localData = JSON.parse(res);\n        console.log(localData);\n        var dateDiff = (new Date() - new Date(localData.datUpdate)) / 1000 / 60;\n        console.log(dateDiff);\n\n        if (dateDiff > 30) {\n          console.log(\"pegou da API\");\n          getFromApi('/GetAtividades?codEve=3').then(function (apiResponse) {\n            loadData = apiResponse;\n            AsyncStorage.setItem('Activities', JSON.stringify({\n              \"datUpdate\": new Date(),\n              \"data\": apiResponse\n            }));\n          });\n        } else {\n          console.log(\"carregou local\");\n          loadData = localData.data;\n        }\n      } else {\n        getFromApi('/GetAtividades?codEve=3').then(function (apiResponse) {\n          console.log(\"pegou da API\");\n          loadData = apiResponse;\n          AsyncStorage.setItem('Activities', JSON.stringify({\n            \"datUpdate\": new Date(),\n            \"data\": apiResponse\n          }));\n        });\n      }\n\n      setActivities(loadData);\n    });\n  }\n\n  useEffect(function () {\n    loadActivities();\n  }, []);\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 3\n    }\n  }, React.createElement(PageHeader, {\n    title: \"Programa\\xE7\\xE3o Cient\\xEDfica data\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 4\n    }\n  }), React.createElement(ScrollView, {\n    style: styles.content,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 4\n    }\n  }, eventDays.map(function (day, index) {\n    return React.createElement(View, {\n      style: styles.item,\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 8\n      }\n    }, React.createElement(TouchableOpacity, {\n      style: styles.itemOption,\n      onPress: function onPress() {\n        return handdleVisibleItem(index);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }\n    }, React.createElement(Text, {\n      style: styles.itemIndex,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 10\n      }\n    }, index + 1), React.createElement(Text, {\n      style: styles.itemTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 10\n      }\n    }, day), React.createElement(Feather, {\n      style: styles.itemIcon,\n      name: visibleItem === index ? 'minus' : 'plus',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 10\n      }\n    })), visibleItem === index && activities.filter(function (act) {\n      return act.DataInicioAtividade === day;\n    }).sort(function (a, b) {\n      return a.iniOrder - b.iniOrder;\n    }).map(function (activity, idx) {\n      return React.createElement(TouchableOpacity, {\n        style: styles.itemContent,\n        key: idx,\n        onPress: function onPress() {\n          return handdleActivityDetails(activity);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 12\n        }\n      }, React.createElement(Text, {\n        style: styles.itemPeriod,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }\n      }, activity.HoraInicioAtividade, \" - \", activity.HoraFimAtividade), React.createElement(Text, {\n        style: styles.itemDescription,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 13\n        }\n      }, activity.DescricaoAtividade));\n    }));\n  })), React.createElement(Modal, {\n    animationType: \"slide\",\n    transparent: true,\n    visible: modalVisible,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.centeredView,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 6\n    }\n  }, React.createElement(View, {\n    style: styles.modalView,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.modalCloseButton,\n    onPress: function onPress() {\n      setModalVisible(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 8\n    }\n  }, React.createElement(Feather, {\n    name: \"x\",\n    color: \"red\",\n    size: 22,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  })), React.createElement(ActivityDetails, {\n    id: currentActivity.AtividadeId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 8\n    }\n  })))));\n}\n\nexport default ProgDate;","map":{"version":3,"sources":["/Volumes/SSD02/Documents/git/cindor_mobile/src/pages/ProgDate/index.tsx"],"names":["React","useState","useEffect","useNavigation","Feather","ScrollView","TouchableOpacity","PageHeader","ActivityDetails","api","styles","ProgDate","activities","setActivities","events","setEvents","loading","setLoading","eventDays","visibleItem","setvisibleItem","modalVisible","setModalVisible","currentActivity","setcurrentActivity","navigation","handdleActivityDetails","act","handdleVisibleItem","index","loadEvents","AsyncStorage","getItem","then","res","localData","JSON","parse","console","log","dateDiff","Date","datUpdate","data","getFromApi","apiResponse","setItem","stringify","endPoint","get","map","a","iniOrder","HoraInicioAtividade","substring","concat","OrdemPalestra","replace","DataInicioAtividade","DataFimAtividade","HoraFimAtividade","loadActivities","loadData","container","content","day","item","itemOption","itemIndex","itemTitle","itemIcon","filter","sort","b","activity","idx","itemContent","itemPeriod","itemDescription","DescricaoAtividade","centeredView","modalView","modalCloseButton","AtividadeId"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, Modal, AsyncStorage } from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { Feather } from '@expo/vector-icons';\nimport { ScrollView, TouchableOpacity } from 'react-native-gesture-handler';\n\nimport PageHeader from '../../Components/PageHeader';\nimport ActivityDetails from '../../Components/ActivityDetails';\n\nimport api from '../../services/api';\nimport styles from './styles';\n\n\nfunction ProgDate(){\n\tconst [activities, setActivities] = useState([]);\n\tconst [events, setEvents] = useState([]);\n\tconst [loading, setLoading] = useState(false);\n\t//const eventDays = [\"12/12/2020\",\"13/12/2020\",\"14/12/2020\",\"15/12/2020\"];\n\tconst eventDays = [\"27/12/1899\",\"28/12/1899\",\"29/12/1899\",\"30/12/1899\"];\n\tconst [visibleItem, setvisibleItem] = useState(0);\n\tconst [modalVisible, setModalVisible] = useState(false);\n\tconst [currentActivity, setcurrentActivity] = useState({});\n\n\tconst navigation = useNavigation();\n\n\tfunction handdleActivityDetails(act){\n\t\tsetcurrentActivity(act);\n\t\tsetModalVisible(true);\n\t}\n\n\tfunction handdleVisibleItem(index){\n\t\t(visibleItem === index ? setvisibleItem(null) : setvisibleItem(index))\n\t}\n\n\tfunction loadEvents(){\n\t\tAsyncStorage.getItem('Events').then(res => {\n\t\t\tif(res){\n\t\t\t\tconst localData = JSON.parse(res);\n\t\t\t\tconsole.log(localData);\n\n\t\t\t\tconst dateDiff = (new Date - new Date(localData.datUpdate))/1000/60;\n\t\t\t\tif(dateDiff > 30){\n\t\t\t\t\tconsole.log(dateDiff);\n\t\t\t\t\tsetEvents(localData.data);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tgetFromApi('?codEve=3').then(apiResponse => {\n\t\t\t\t\tsetEvents(apiResponse);\n\n\t\t\t\t\tconst localData = {\n\t\t\t\t\t\t\"datUpdate\" : new Date(),\n\t\t\t\t\t\t\"data\": apiResponse\n\t\t\t\t\t}\n\n\t\t\t\t\tAsyncStorage.setItem('Events', JSON.stringify(localData));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t})\n\t}\n\n\tasync function getFromApi(endPoint){\n\t\tconst res = await api.get(endPoint,{})\n\n\t\tconst data = res.data.map( a => ({...a,\n\t\t\tiniOrder: \n\t\t\t\ta.HoraInicioAtividade.substring(0,10)\n\t\t\t\t.concat(a.HoraInicioAtividade.substring(11,16))\n\t\t\t\t.concat(a.OrdemPalestra)\n\t\t\t\t.replace(/:|-/g, \"\"),\n\t\t\tHoraInicioAtividade: a.HoraInicioAtividade.substring(11,16),\n\t\t\tDataInicioAtividade: a.HoraInicioAtividade.substring(8,10).concat(\"/\")\n\t\t\t\t.concat(a.HoraInicioAtividade.substring(5,7)).concat(\"/\")\n\t\t\t\t.concat(a.HoraInicioAtividade.substring(0,4)),\n\t\t\tDataFimAtividade: a.HoraFimAtividade.substring(8,10).concat(\"/\")\n\t\t\t\t.concat(a.HoraFimAtividade.substring(5,7)).concat(\"/\")\n\t\t\t\t.concat(a.HoraFimAtividade.substring(0,4)),\n\t\t\tHoraFimAtividade: a.HoraFimAtividade.substring(11,16)\n\t\t}));\n\n\t\treturn data;\n\t}\n\n\tfunction loadActivities(){\n\t\t\n\t\tAsyncStorage.getItem('Activities').then(res => {\n\t\t\tconsole.log(res);\n\t\t\tlet loadData = [];\n\n\t\t\tif(res){ // if has local data\n\t\t\t\tconst localData = JSON.parse(res);\n\t\t\t\tconsole.log(localData);\n\t\t\t\t\n\t\t\t\tconst dateDiff = (new Date - new Date(localData.datUpdate))/1000/60;\n\t\t\t\tconsole.log(dateDiff);\n\t\t\t\t\n\t\t\t\tif(dateDiff > 30){ // if local data is not recent we will call the api\n\t\t\t\t\tconsole.log(\"pegou da API\");\n\n\t\t\t\t\tgetFromApi('/GetAtividades?codEve=3').then(apiResponse => {\n\t\t\t\t\t\tloadData = apiResponse;\n\t\t\t\t\t\tAsyncStorage.setItem('Activities', JSON.stringify({ \"datUpdate\": new Date(),\"data\": apiResponse }));\n\t\t\t\t\t});\n\n\t\t\t\t}else{ // if local data is recent (30 min or earlier)\n\t\t\t\t\tconsole.log(\"carregou local\");\n\t\t\t\t\tloadData = localData.data;\n\t\t\t\t}\n\t\t\t}else{ // if we dont have local data\n\t\t\t\tgetFromApi('/GetAtividades?codEve=3').then(apiResponse => {\n\t\t\t\t\tconsole.log(\"pegou da API\");\n\t\t\t\t\tloadData = apiResponse;\n\n\t\t\t\t\tAsyncStorage.setItem('Activities', JSON.stringify({ \"datUpdate\": new Date(),\"data\": apiResponse }));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\n\t\t\tsetActivities(loadData);\n\t\t})\n\t\t\t\n\t}\n\n\tuseEffect(() => {\n\t\tloadActivities();\n\n\t\t// const clearAppData = async function() {\n\t\t// \ttry {\n\t\t// \t\tconst keys = await AsyncStorage.getAllKeys();\n\t\t// \t\tawait AsyncStorage.multiRemove(keys);\n\t\t// \t} catch (error) {\n\t\t// \t\tconsole.error('Error clearing app data.');\n\t\t// \t}\n\t\t// }\n\t}, []);\n\n\treturn(\n\t\t<View style={styles.container}>\n\t\t\t<PageHeader title=\"Programação Científica data\"/>\n\n\t\t\t<ScrollView style={styles.content}>\n\t\t\t\t{\n\t\t\t\t\teventDays.map((day,index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<View style={styles.item} key={index}>\n\t\t\t\t\t\t\t\t<TouchableOpacity style={styles.itemOption} onPress={() => handdleVisibleItem(index)}>\n\t\t\t\t\t\t\t\t\t<Text style={styles.itemIndex}>{index+1}</Text>\n\t\t\t\t\t\t\t\t\t<Text style={styles.itemTitle}>{day}</Text>\n\t\t\t\t\t\t\t\t\t<Feather style={styles.itemIcon} name={(visibleItem === index ? ('minus'): ('plus'))}></Feather>\n\t\t\t\t\t\t\t\t</TouchableOpacity>\n\n\t\t\t\t\t\t\t\t{ visibleItem === index && (\n\t\t\t\t\t\t\t\t\tactivities.filter(act => act.DataInicioAtividade === day)\n\t\t\t\t\t\t\t\t\t.sort((a,b) => a.iniOrder - b.iniOrder)\n\t\t\t\t\t\t\t\t\t.map((activity, idx) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<TouchableOpacity style={styles.itemContent} key={idx} onPress={() => handdleActivityDetails(activity)}>\n\t\t\t\t\t\t\t\t\t\t\t\t<Text style={styles.itemPeriod}>{activity.HoraInicioAtividade} - {activity.HoraFimAtividade}</Text>\n\t\t\t\t\t\t\t\t\t\t\t\t<Text style={styles.itemDescription}>{activity.DescricaoAtividade}</Text>\n\t\t\t\t\t\t\t\t\t\t\t</TouchableOpacity>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t}\t\t\t\t\n\t\t\t</ScrollView>\n\n\t\t\t\n\t\t\t\t<Modal\n\t\t\t\t\tanimationType=\"slide\"\n\t\t\t\t\ttransparent={true}\n\t\t\t\t\tvisible={modalVisible}\n\t\t\t\t>\n\t\t\t\t\t<View style={styles.centeredView}>\n\t\t\t\t\t\t<View style={styles.modalView}>\n\n\t\t\t\t\t\t\t<TouchableOpacity style={styles.modalCloseButton} onPress={() => { setModalVisible(false) }} >\n\t\t\t\t\t\t\t\t<Feather name=\"x\" color='red' size={22}></Feather>\n\t\t\t\t\t\t\t</TouchableOpacity>\n\n\t\t\t\t\t\t\t<ActivityDetails id={currentActivity.AtividadeId}/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t</Modal>\n\t\t\t\n\n\t\t</View>\n\t)\n\t\n}\n\nexport default ProgDate;"]},"metadata":{},"sourceType":"module"}